# Dockerfile (backend 폴더 루트에 있어야 한다) 그니까 이미지를 만들기 위한 상세 레시피 같은 것

# 1단계: 바탕 준비하기
# 어떤 깨끗한 컴퓨터 환경에서 시작할지 고른다.
# 우리 백엔드는 Java 17이 필요하니까, "이미 Java 17 깔려있는 리눅스 컴퓨터"를 가져오라고 시킨다.
# 'slim'은 용량 작은 버전이라 더 좋다.
FROM openjdk:17-jdk-slim

# 2단계: 작업 공간 만들기
# 가져온 리눅스 컴퓨터(컨테이너) 안에 '/app'이라는 이름의 작업 폴더를 만든다.
# 앞으로 파일 복사나 명령어 실행은 이 폴더 안에서 할 거다. (정리정돈!)
WORKDIR /app

# 3단계: 우리 프로그램 옮기기
# 내 맥북에서 미리 만들어 둔 우리 백엔드 프로그램 파일(Jar 파일)을
# 컨테이너 안의 '/app' 폴더로 복사한다. 이름은 'app.jar'로 바꿔서 넣는다.
# (이 Jar 파일은 좀 이따가 Gradle이라는 도구로 만들 거다)
COPY ./build/libs/*-SNAPSHOT.jar app.jar

# 4단계: 안내문 붙이기 (선택사항)
# "이 프로그램은 내부적으로 8080 포트를 사용해요~"라고 안내 스티커를 붙이는 거다.
# 이걸 쓴다고 진짜 문(포트)이 열리는 건 아니다. 그냥 알려주는 표시!
EXPOSE 8080

# 5단계: 실행 버튼 만들기
# 이 포장 상자(이미지)를 나중에 열 때(컨테이너 실행할 때)
# 자동으로 "java -jar app.jar" 명령어를 실행해서 우리 프로그램을 딱! 켜주라고 설정하는 거다.
# 이게 우리 백엔드 서버를 시작시키는 핵심 명령어다.
ENTRYPOINT ["java", "-jar", "app.jar"]

